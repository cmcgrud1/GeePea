<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fitting a transit light curve &mdash; GeePea 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="GeePea 1.0 documentation" href="index.html" />
    <link rel="next" title="Inference of hyperparameters" href="inference.html" />
    <link rel="prev" title="Regression using GPs" href="regression.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="inference.html" title="Inference of hyperparameters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="regression.html" title="Regression using GPs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fitting-a-transit-light-curve">
<h1>Fitting a transit light curve<a class="headerlink" href="#fitting-a-transit-light-curve" title="Permalink to this headline">Â¶</a></h1>
<p>For this example I will use the light curve model from MyFuncs module (available from
<a class="reference external" href="https://github.com/nealegibson/">https://github.com/nealegibson/</a>). This accepts 9 transit parameters, and a time argument, eg.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">MyFuncs</span> <span class="kn">as</span> <span class="nn">MF</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">mfp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">11.</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]</span> <span class="c"># mean function pars</span>

<span class="n">flux</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">Transit_aRs</span><span class="p">(</span><span class="n">mfp</span><span class="p">,</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>First define hyperparameters, and generate some noisy test data, with some &#8216;systematics&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0003</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.0003</span><span class="p">]</span>

<span class="c">#create the data set (ie training data) with some simulated systematics</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">Transit_aRs</span><span class="p">(</span><span class="n">mfp</span><span class="p">,</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="n">hp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">10.</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">hp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">time</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>We also need to specify which parameters to fix. We can use the fixed parameters arg (fp),
or alternatively pass an error array to the GP, corresponding to the mean function and kernel
parameters. This is convenineet if we need to specify the errors for an MCMC anyway:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ep</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we can define the GP. We&#8217;ll just model the systematics as a regularly sampled function of time,
so can use a Toeplitz kernel to speed things up. In this example we&#8217;ll use the squared exponential
kernel again, but for time-correlated systeamatics, I&#8217;ve found the <a class="reference internal" href="normal_kernels.html#GeePea.Matern32" title="GeePea.Matern32"><code class="xref py py-func docutils literal"><span class="pre">Matern</span> <span class="pre">3/2</span></code></a> kernel a better option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#using normal kernel</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">GeePea</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">mfp</span><span class="o">+</span><span class="n">hp</span><span class="p">,</span><span class="n">mf</span><span class="o">=</span><span class="n">MF</span><span class="o">.</span><span class="n">Transit_aRs</span><span class="p">,</span><span class="n">ep</span><span class="o">=</span><span class="n">ep</span><span class="p">)</span> <span class="c">#using normal SqExponential kernel</span>

<span class="c">#or using a toeplitz kernel</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">GeePea</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">flux</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">mfp</span><span class="o">+</span><span class="n">hp</span><span class="p">,</span><span class="n">kf</span><span class="o">=</span><span class="n">GeePea</span><span class="o">.</span><span class="n">ToeplitzSqExponential</span><span class="p">,</span><span class="n">mf</span><span class="o">=</span><span class="n">MF</span><span class="o">.</span><span class="n">Transit_aRs</span><span class="p">,</span><span class="n">ep</span><span class="o">=</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can optimise and plot as before:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#optimise the free parameters</span>
<span class="n">gp</span><span class="o">.</span><span class="n">optimise</span><span class="p">()</span>
<span class="n">gp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using a Toeplitz kernel, the predictive distribution of the GP doesn&#8217;t work if the
predictive points do not have the same spacing as the inputs. If this isn&#8217;t possible, or you
need a finer grid for plotting/whatever, then you can switch to an equivalent full kernel after
the optimisation/marginalisation.</p>
</div>
<p>(<a class="reference external" href=".//light_curve_eg-1.py">Source code</a>, <a class="reference external" href=".//light_curve_eg-1.png">png</a>, <a class="reference external" href=".//light_curve_eg-1.hires.png">hires.png</a>, <a class="reference external" href=".//light_curve_eg-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/light_curve_eg-1.png" src="_images/light_curve_eg-1.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">GeePea</a></h1>







  <h4>Previous topic</h4>
  <p class="topless"><a href="regression.html"
                        title="previous chapter">Regression using GPs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inference.html"
                        title="next chapter">Inference of hyperparameters</a></p><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gps.html">GPs in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="mean_functions.html">Using Mean Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernel_selection.html">Defining kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">Regression using GPs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Fitting a transit light curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference of hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="normal_kernels.html">Built-in &#8216;normal&#8217; kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="toeplitz_kernels.html">Built-in Toeplitz kernels</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Neale Gibson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.3</a>
      
      |
      <a href="_sources/light_curve_eg.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>